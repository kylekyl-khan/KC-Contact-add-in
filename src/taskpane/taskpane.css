/* taskpane.css */

/* === 全局基礎設定 === */
html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden; /* 禁止整個視窗出現卷軸，強制在區塊內滾動 */
    font-family: "Segoe UI", "Roboto", sans-serif;
    font-size: 14px;
    box-sizing: border-box; /* 確保 padding 不會撐大寬度 */
}

/* 讓所有元素都繼承 box-sizing */
*, *:before, *:after {
    box-sizing: inherit;
}

#app-body {
    display: flex;
    flex-direction: column;
    height: 100vh; /* 佔滿 100% 視窗高度 */
    background-color: #fff;
}

/* =========================================
   區塊 1: 搜尋列 (假設您有這個區塊，若無可忽略)
   設定: 固定高度 60px，不伸縮
   ========================================= */
#search-section, .search-container {
    flex: 0 0 60px; /* 固定高度，不隨視窗比例改變 */
    
    padding: 10px;
    background-color: #f3f2f1;
    border-bottom: 1px solid #e1dfdd;
    display: flex;
    align-items: center;
}

/* =========================================
   區塊 2: 組織樹
   設定: 固定佔高 30%，內容多了出現卷軸
   ========================================= */
#org-tree {
    flex: 0 0 30%; /* 鎖死高度 30% */
    
    overflow-y: auto; /* 內容多時，卷軸只出現在這裡 */
    padding: 10px;
    border-bottom: 4px solid #e1dfdd; /* 加粗分隔線，讓區塊更明顯 */
    background-color: #fff;
}

/* =========================================
   區塊 3: 人員列表
   設定: 固定佔高 40% (最主要的區域)
   ========================================= */
#contacts-list {
    flex: 0 0 40%; /* 鎖死高度 40% */
    
    overflow-y: auto; /* 內容多時，卷軸只出現在這裡 */
    padding: 0;
    background-color: #fff;
    border-bottom: 4px solid #e1dfdd; /* 加粗分隔線 */
}

/* =========================================
   區塊 4: 已選人員 + 按鈕區 (底部區)
   設定: 自動填滿剩下的空間 (約 25%-30%)
   注意：這裡包含兩個部分，我們把它們包在一起看
   ========================================= */

/* 4-1. 已選人員清單 */
#selection-area {
    /* 這裡使用 flex: 1 讓它佔據底部的「剩餘空間」 */
    flex: 1; 
    
    overflow-y: auto; /* 選太多人時，這裡會有卷軸 */
    padding: 10px;
    background-color: #faf9f8;
    border-bottom: 1px solid #edebe9;
    min-height: 80px; /* 至少保留一點高度給它 */
}

/* 4-2. 按鈕群組 (釘死在最下面) */
.button-group {
    flex: 0 0 auto; /* 高度隨內容自動，但不伸縮 */
    
    padding: 12px;
    background-color: #f8f8f8;
    border-top: 1px solid #c8c6c4;
    display: flex;
    gap: 10px;
    justify-content: flex-end;
}


/* === 以下是美化樣式 (維持不變) === */

/* 樹狀節點 */
.tree-node { user-select: none; }
.node-title {
    padding: 6px 8px;
    border-radius: 2px;
    display: flex;
    align-items: center;
    cursor: pointer;
}
.node-title:hover { background-color: #f3f2f1; }

/* 聯絡人項目 */
.contact-item {
    padding: 10px 15px;
    border-bottom: 1px solid #f3f2f1;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
}
.contact-item:hover { background-color: #fbfbfb; }

/* 標籤樣式 */
.recipient-tag {
    display: inline-flex;
    align-items: center;
    background-color: #deecf9;
    color: #005a9e;
    padding: 4px 10px;
    margin: 3px;
    border-radius: 15px;
    font-size: 13px;
    font-weight: 500;
}
.recipient-tag span {
    margin-left: 6px;
    cursor: pointer;
    font-weight: bold;
    color: #d13438;
}

/* 按鈕樣式 */
button {
    cursor: pointer;
    border: 1px solid #8a8886;
    background-color: #fff;
    padding: 6px 16px;
    border-radius: 4px;
    font-size: 13px;
    font-weight: 600;
}
button:hover { background-color: #f3f2f1; }

#btn-add-to, #btn-add-cc, #btn-add-bcc {
    background-color: #0078d4;
    color: white;
    border-color: #0078d4;
}
#btn-add-to:hover { background-color: #106ebe; }

#clear-selection-btn {
    border: none;
    color: #a4262c;
}